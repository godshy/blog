<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Deploy kubernetes and datadog on AWS | Hongyi&#39;s blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="Deploy Kubernetes cluster on AWS, then perform monitoring and enable observability using datadogIn this blog, I want to test deploying a kubernetes with 2 worker nodes and 1 master node, worker nodes">
<meta property="og:type" content="article">
<meta property="og:title" content="Deploy kubernetes and datadog on AWS">
<meta property="og:url" content="https://godshy.github.io/blog/2026/01/29/Deploy-kubernetes-and-datadog-on-AWS/index.html">
<meta property="og:site_name" content="Hongyi&#39;s blog">
<meta property="og:description" content="Deploy Kubernetes cluster on AWS, then perform monitoring and enable observability using datadogIn this blog, I want to test deploying a kubernetes with 2 worker nodes and 1 master node, worker nodes">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://s2.loli.net/2026/01/29/mtqsnkbhXKY4AVR.png">
<meta property="og:image" content="https://s2.loli.net/2026/01/29/d2pwOvitNB3berf.png">
<meta property="og:image" content="https://s2.loli.net/2026/01/29/senbyGNAwap6VCu.png">
<meta property="og:image" content="https://s2.loli.net/2026/01/29/TVmNnW3XL7BFMdh.png">
<meta property="og:image" content="https://s2.loli.net/2026/01/29/v7GNjkq9sPD1WyR.png">
<meta property="og:image" content="https://s2.loli.net/2026/01/29/6HoTKMNCDcxfbwp.png">
<meta property="article:published_time" content="2026-01-29T05:15:27.000Z">
<meta property="article:modified_time" content="2026-01-29T15:22:44.776Z">
<meta property="article:author" content="Hongyi Shen">
<meta property="article:tag" content="AWS, K8s">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://s2.loli.net/2026/01/29/mtqsnkbhXKY4AVR.png">
  
    <link rel="alternate" href="/blog/atom.xml" title="Hongyi's blog" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/blog/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/blog/css/style.css">

  
    
<link rel="stylesheet" href="/blog/fancybox/jquery.fancybox.min.css">

  
  
<meta name="generator" content="Hexo 6.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/blog/" id="logo">Hongyi&#39;s blog</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"><span class="fa fa-bars"></span></a>
        
          <a class="main-nav-link" href="/blog/">Home</a>
        
          <a class="main-nav-link" href="/blog/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
        
          <a class="nav-icon" href="/blog/atom.xml" title="RSS Feed"><span class="fa fa-rss"></span></a>
        
        <a class="nav-icon nav-search-btn" title="Search"><span class="fa fa-search"></span></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://godshy.github.io/blog"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-Deploy-kubernetes-and-datadog-on-AWS" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/blog/2026/01/29/Deploy-kubernetes-and-datadog-on-AWS/" class="article-date">
  <time class="dt-published" datetime="2026-01-29T05:15:27.000Z" itemprop="datePublished">2026-01-29</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/blog/categories/DIY-and-lab/">DIY and lab</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="p-name article-title" itemprop="headline name">
      Deploy kubernetes and datadog on AWS
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="Deploy-Kubernetes-cluster-on-AWS-then-perform-monitoring-and-enable-observability-using-datadog"><a href="#Deploy-Kubernetes-cluster-on-AWS-then-perform-monitoring-and-enable-observability-using-datadog" class="headerlink" title="Deploy Kubernetes cluster on AWS, then perform monitoring and enable observability using datadog"></a>Deploy Kubernetes cluster on AWS, then perform monitoring and enable observability using datadog</h1><p>In this blog, I want to test deploying a kubernetes with 2 worker nodes and 1 master node, worker nodes are deployed on different AZs.</p>
<p>I will firstly set up EC-2 with the dumbest way (set up manually with all handcrafts and then set up kubernetes manually) and set datadog to try monitor the kubernetes environment. Then try using terraform, ansible to make the process easier, and temper with some fancy parts(different deploy patterns, ELBs, other services) on AWS.</p>
<h2 id="Set-up-EC2-instance"><a href="#Set-up-EC2-instance" class="headerlink" title="Set up EC2 instance"></a>Set up EC2 instance</h2><p>Launch EC2 instance first, open console, search for EC2 and click Launch instances</p>
<p>Configure following:</p>
<ul>
<li>Name and tages: Master x1 and Worker x2</li>
<li>Application and OS image: I chose Ubuntu, but any other distribution is OK</li>
<li>Key pair: it is used to connect to the instance remotelly, I set one for master and one for works</li>
<li>Network settings: For one worker, change Subnet to let it placed in a different AZ from other instances. Other parameters just leave them default here. (For security group, it will create security group and allow inbound SSH only in default we can change it later.)</li>
</ul>
<p>Others leave the same. And click launch</p>
<p><img src="https://s2.loli.net/2026/01/29/mtqsnkbhXKY4AVR.png" alt="ec2 launch.png"></p>
<p><img src="https://s2.loli.net/2026/01/29/d2pwOvitNB3berf.png" alt="ec2 launch 2.png"></p>
<p>After launch successful, we should see all three instance are up and running. By default, these 3 instances are attached with public ipv4 ip address and attached default internet gateway, so we can ssh to them using key pair created previously. Notice that one workerâ€™s AZ is different from the others.</p>
<p><img src="https://s2.loli.net/2026/01/29/senbyGNAwap6VCu.png" alt="1.1 3 ec2 launched on aws.png"></p>
<p>Then we connect to them using terminal and do some initial configurations:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get upgrade</span><br><span class="line">sudo hostnamectl set-hostname Master1/Worker1/Worker2</span><br><span class="line">sudo reboot</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>Return to console, since by default security group only allow inbound SSH, we need to configure network access with each node. Go to security groups, click create new security group and specify a good name for each instance. Firstly allow ssh from anywhere, then add new inbound rules from other instances. For example SG for mmaster should allow traffic from worker1 and worker2. After configured all of the SGs, go to instance -&gt; Actions -&gt; Security -&gt; Change security groups,<br>Unbind the default SG and attach created new SG to it.</p>
<p><img src="https://s2.loli.net/2026/01/29/TVmNnW3XL7BFMdh.png" alt="SG.png"></p>
<p><img src="https://s2.loli.net/2026/01/29/v7GNjkq9sPD1WyR.png" alt="sg configure.png"></p>
<p><img src="https://s2.loli.net/2026/01/29/6HoTKMNCDcxfbwp.png" alt="SG detach.png"></p>
<p>Check ping for each instance, no ping should get through.</p>
<p>Modify <code>/etc/hosts</code>. add hostname for each other. So that each instance can ping with others with their hostname.</p>
<p><em><strong>Important things to be noticed:</strong></em></p>
<ul>
<li>Since there is no Elastic IP attached, after instance is relaunched thru console, Public IP will change</li>
<li>Micro EC2 (mem under 2048) may have some problem when installing kubernetes control plane components. We may need to change instance type for larger memory.</li>
</ul>
<p>Refer to <a href="https://godshy.github.io/blog/2026/01/05/Deploy-k8s-cluster/">Install k8s on vm</a> for the cluster installation.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://godshy.github.io/blog/2026/01/29/Deploy-kubernetes-and-datadog-on-AWS/" data-id="cmkzmweom0005l4ur99ua9str" data-title="Deploy kubernetes and datadog on AWS" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/AWS-K8s/" rel="tag">AWS, K8s</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
  
    <a href="/blog/2026/01/22/kubernetes-security/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">kubernetes security</div>
    </a>
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/blog/categories/DIY-and-lab/">DIY and lab</a></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/Learning/">Learning</a></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/commands/">commands</a></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/security/">security</a></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/troubleshooting/">troubleshooting</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/AWS-K8s/" rel="tag">AWS, K8s</a></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/Cloud-native/" rel="tag">Cloud native</a></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/K8s/" rel="tag">K8s</a></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/Linux/" rel="tag">Linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/PKI-encryption-TLS/" rel="tag">PKI, encryption, TLS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/k8s-helm/" rel="tag">k8s, helm</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/blog/tags/AWS-K8s/" style="font-size: 10px;">AWS, K8s</a> <a href="/blog/tags/Cloud-native/" style="font-size: 10px;">Cloud native</a> <a href="/blog/tags/K8s/" style="font-size: 20px;">K8s</a> <a href="/blog/tags/Linux/" style="font-size: 15px;">Linux</a> <a href="/blog/tags/PKI-encryption-TLS/" style="font-size: 10px;">PKI, encryption, TLS</a> <a href="/blog/tags/k8s-helm/" style="font-size: 15px;">k8s, helm</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2026/01/">January 2026</a></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2024/07/">July 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2024/02/">February 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2023/10/">October 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2023/08/">August 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2023/06/">June 2023</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/blog/2026/01/29/Deploy-kubernetes-and-datadog-on-AWS/">Deploy kubernetes and datadog on AWS</a>
          </li>
        
          <li>
            <a href="/blog/2026/01/22/kubernetes-security/">kubernetes security</a>
          </li>
        
          <li>
            <a href="/blog/2026/01/05/deploy-5gc-on-kubernetes/">Deploy-5gc-on-kubernetes</a>
          </li>
        
          <li>
            <a href="/blog/2026/01/05/Deploy-k8s-cluster/">Deploy kubernetes cluster on virtual machine</a>
          </li>
        
          <li>
            <a href="/blog/2024/07/18/PKI-and-encryption-explained-step-by-step/">PKI and encryption explained step by step</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2026 Hongyi Shen<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/blog/" class="mobile-nav-link">Home</a>
  
    <a href="/blog/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/blog/js/jquery-3.6.4.min.js"></script>



  
<script src="/blog/fancybox/jquery.fancybox.min.js"></script>




<script src="/blog/js/script.js"></script>





  </div>
</body>
</html>